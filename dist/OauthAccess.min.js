/**
 * OauthAccess.js - v0.1.2 
 * Copyright (c) 2015 Kiva Microfunds
 * 
 * Licensed under the MIT license.
 * https://github.com/kiva/OauthAccess/blob/master/license.txt
 */
!function(){"use strict";function a(b){a.extend(this,b)}function b(a,b){return j(f(a,b))}function c(a,b){a[b>>5]|=128<<24-b%32,a[(b+64>>9<<4)+15]=b;for(var c=Array(80),f=1732584193,i=-271733879,j=-1732584194,k=271733878,l=-1009589776,m=0;m<a.length;m+=16){for(var n=f,o=i,p=j,q=k,r=l,s=0;80>s;s++){c[s]=16>s?a[m+s]:h(c[s-3]^c[s-8]^c[s-14]^c[s-16],1);var t=g(g(h(f,5),d(s,i,j,k)),g(g(l,c[s]),e(s)));l=k,k=j,j=h(i,30),i=f,f=t}f=g(f,n),i=g(i,o),j=g(j,p),k=g(k,q),l=g(l,r)}return Array(f,i,j,k,l)}function d(a,b,c,d){return 20>a?b&c|~b&d:40>a?b^c^d:60>a?b&c|b&d|c&d:b^c^d}function e(a){return 20>a?1518500249:40>a?1859775393:60>a?-1894007588:-899497514}function f(a,b){var d=i(a);d.length>16&&(d=c(d,a.length*l));for(var e=Array(16),f=Array(16),g=0;16>g;g++)e[g]=909522486^d[g],f[g]=1549556828^d[g];var h=c(e.concat(i(b)),512+b.length*l);return c(f.concat(h),672)}function g(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function h(a,b){return a<<b|a>>>32-b}function i(a){for(var b=Array(),c=(1<<l)-1,d=0;d<a.length*l;d+=l)b[d>>5]|=(a.charCodeAt(d/l)&c)<<32-l-d%32;return b}function j(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c="",d=0;d<4*a.length;d+=3)for(var e=(a[d>>2]>>8*(3-d%4)&255)<<16|(a[d+1>>2]>>8*(3-(d+1)%4)&255)<<8|a[d+2>>2]>>8*(3-(d+2)%4)&255,f=0;4>f;f++)c+=8*d+6*f>32*a.length?k:b.charAt(e>>6*(3-f)&63);return c}a.extend=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},a.arrayify=function(a){if("object"!=typeof a)throw"Data must be an [object]";var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push({key:c,val:a[c]});return b},a.generateNonce=function(){return 1e7*Math.random()},a.generateTimestamp=function(){return parseInt((new Date).getTime()/1e3,10)},a.serializeParams=function(a){var b,c="";for(b=0;b<a.length;b++)c+=a[b].key+"%3D"+a[b].val,b<a.length-1&&(c+="%26");return c},a.parseQueryParams=function(a){for(var b,c=[],d=a.split("&"),e=0;e<d.length;e++)b=d[e].split("="),c.push({key:b[0],val:b[1]});return c},a.encodeParams=function(a){var b,c=[];for(b=0;b<a.length;b++)c[b]={key:encodeURIComponent(a[b].key),val:encodeURIComponent(a[b].val)};return c},a.sortParams=function(a){return a.sort(function(a,b){var c=a.key,d=b.key;return d>c?-1:c>d?1:0})},a.generateSignature=function(c,d,e,f,g,h,i,j,k,l){var m;return e.push({key:"oauth_callback",val:l}),e.push({key:"oauth_consumer_key",val:k}),e.push({key:"oauth_nonce",val:f}),e.push({key:"oauth_signature_method",val:j}),e.push({key:"oauth_timestamp",val:g}),e.push({key:"oauth_token",val:h}),e.push({key:"oauth_version",val:"1.0"}),e=a.sortParams(e),e=a.encodeParams(e),e=a.serializeParams(e),m=c.toUpperCase()+"&"+encodeURIComponent(d).toString()+"&"+e,b(i,m)+"="},a.generateHeader=function(b,c,d,e,f,g,h,i){if(d=d?a.arrayify(d):[],"string"!=typeof b&&(b="GET"),!c)throw'Unable to generate an authorization header: No "url" provided';f=f||"",i=encodeURIComponent(i),h=encodeURIComponent(h),e=encodeURIComponent(e);var j,k,l=a.generateNonce(),m=a.generateTimestamp(),n=c.indexOf("?");return n>-1?(j=c.slice(0,n),d=d.concat(a.parseQueryParams(c.slice(n+1)))):j=c,k=a.generateSignature(b,j,d,l,m,e,encodeURIComponent(f),g,h,i),'OAuth oauth_nonce="'+encodeURIComponent(l)+'",oauth_callback="'+i+'",oauth_signature_method="'+g+'",oauth_timestamp="'+encodeURIComponent(m)+'",oauth_consumer_key="'+h+'",oauth_signature="'+k+'",oauth_token="'+e+'",oauth_version="1.0"'},a.prototype={generateHeader:function(b,c,d){var e=this.accessTokens;return a.generateHeader(b,c,d,e.token,e.tokenSecret,this.signatureMethod,this.key,this.callback)}};var k="",l=8;return a}();